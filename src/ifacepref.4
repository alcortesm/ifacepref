.\" nroff source of ifacepref manpage
.\" alcortes@it.uc3m.es 2009-04-12
.\"
.\" groff -man ifacepref.4 | col -b > ifacepref_manpage.txt
.\" groff -man -Tps ifacepref.4 > ifacepref_manpage.ps
.\" groff -man -Tps ifacepref.4 | ps2pdf - - > ifacepref_manpage.pdf
.\" groff -man -Thtml ifacepref.4 > ifacepref_manpage.html
.\"
.TH IFACEPREF 4 2009-04-12 "Linux" "Linux Programmer's Manual"
.SH NAME
\fBifacepref\fP \- preferred network interface device
.SH DESCRIPTION
The character special file \fI/dev/ifacepref\fP provide
an interface to set and get the preferred network interface
card.
.LP
The preferred network interface device stores the name of
a network interface card. Privileged users can set the
preferred network interface at leisure. Users, applications and
other kernel modules can read the preferred network interface
as an input for its policies, routing decisions...
.SS Usage
Writting the name of the preferred iface to \fI/dev/ifacepref\fP
will make the device remember it. It can be changed afterwards by
aditional writes.
.LP
Network interface names are no longer than \fBIFNAMSIZ\fP bytes. Any attempt to
write more than \fBIFNAMSIZ\fP bytes in the device will fail.
.LP
Write operations are atomic: each write system call will set a
new preferred iface; don't try to splice a write between severall
system calls as any attempt to write at a non-zero offset
will fail.
.LP
Read operations don't need to be atomic. But as interface names are quite
small (16 bytes for most kernels), it is easy to read the whole device
in only one go.
.SS Configuration
If your system does not have
\fI/dev/ifacepref\fP created already, you will
have to create it by hand. It can be created with the following commands.
Major and minor numbers are dynamically
assigned by default when the module is loaded so you will need to
use \fBlsmod\fP to ask the system about them:

.nf
    ; lsmod | grep ifacepref
    ifacepref             254  0
    ; mknod /dev/ifacepref c 254 0
    ; chmod 664 /dev/ifacepref
    ; chown root:root /dev/ifacepref
.fi

.SS "/proc Interface"
There is no \fB/proc\fP interface (yet).
.SS "/sys Interface"
There is no \fB/sys\fP interface (yet).
.SH EXAMPLES
To set \fIeth0\fP as the preferred interface:

.nf
    ; echo -n "eth0" > /dev/ifacepref
.fi

To get the preferred interface:

.nf
    ; cat /dev/ifacepref
.fi

.SH FILES
.I /dev/ifacepref
.SH BUGS
There are race conditions on concurrent writes.
.LP
Module execution is too verbose.
.LP
The iface name is not checked for existance.
.SH AUTHOR
The kernel's ifacepref device was written by
Alberto Cortes (alcortes@it.uc3m.es).
.SH "SEE ALSO"
\fBnetdevice\fP(7), \fBwrite\fP(2), \fBlsmod\fP(8)
